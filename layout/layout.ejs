<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="<%- page.description %>">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title><%- page.title %> | <%- config.title %></title>
    <link rel="icon" href="<%- config.favicon || 'https://www.meteor.com/favicon.png' %>" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,300italic,400italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/style/main.css">
    <link href="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel='stylesheet' type='text/css'>
  </head>
  <body>
    <%- body %>
    <script src="/script/smooth-scroll.min.js"></script>
    <script src="/script/main.js"></script>
    <script src="/script/redirects.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script>
      // nectar ninja
      // (function(){
      //   var handle = '@meteorjs';
      //   var a = document.createElement('script');
      //   var m = document.getElementsByTagName('script')[0];
      //   a.async = 1;
      //   a.src = 'https://nectar.ninja/api/v1/' + handle.slice(1);
      //   m.parentNode.insertBefore(a, m);
      // })();

      // mobile
      document.querySelector('#mobile-header .menu-button')
        .addEventListener('click', function () {
          document.body.classList.toggle('sidebar-open')
        })
      document.getElementById('mobile-shade').addEventListener('click', function () {
        document.body.classList.remove('sidebar-open')
      })

      <% if (config.apis.ga) { %>
        // Google analytics
        ;(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', '<%- config.apis.ga %>', 'auto');
        ga('send', 'pageview');
      <% } %>

      <% if (config.apis.marketo) { %>
        // Marketo
        (function() {
          var didInit = false;
          function initMunchkin() {
            if(didInit === false) {
              didInit = true;
              Munchkin.init('<%- config.apis.marketo %>');
            }
          }
          var s = document.createElement('script');
          s.type = 'text/javascript';
          s.async = true;
          s.src = '//munchkin.marketo.net/munchkin.js';
          s.onreadystatechange = function() {
            if (this.readyState == 'complete' || this.readyState == 'loaded') {
              initMunchkin();
            }
          };
          s.onload = initMunchkin;
          document.getElementsByTagName('head')[0].appendChild(s);
        })();
      <% } %>

      // search box
      <% if (config.apis.swiftype) { %>
        ;(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
        (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
        })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
        _st('install','<%- config.apis.swiftype %>','2.0.0');
      <% } else if (config.apis.docsearch) { %>
        docsearch({
          apiKey: '<%- config.apis.docsearch.apiKey %>',
          indexName: '<%- config.apis.docsearch.indexName %>',
          inputSelector: '#search-input',
        });
      <% } %>
    </script>
  </body>
</html>
